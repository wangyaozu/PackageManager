# PackageManager 变更日志

本文件基于仓库 `gitlog.md` 的提交历史按版本号归档，概述每个版本的主要改动与新增功能。

## 2.0.2.1 — 2025-12-04

- Revit日志查看功能：
  - 包管理页面操作区新增 按钮`Revit日志` 用于查看所选Revit版本下的Journal日志。
  - 新增ProductLogsPage对Revit日志目录的支持
  - 实现从产品页面跳转到日志查看器并传递Revit目录
  - 支持显示和刷新Revit Journals目录下的日志文件
  - 优化日志文件列表展示和排序方式，最新的显示在最上方
  - 提供返回主页和重新选择目录的功能


提交参考：
- fe95ce7dfad5606f1d855f6fe1d5858eb2bc722d — feat(logs): 新增Revit日志查看功能

## 2.0.2.0 — 2025-12-03

- 调试选项功能：
  - 新增 `DebugOptionsWindow` 用于编辑调试配置。
  - 加载与保存 `DebugSetting.json`，支持属性表查看与编辑。
  - 在包管理界面添加“调试选项”按钮。
  - 扩展 `PackageInfo` 以支持调试选项命令。
  - 将“模式切换”按钮更名为“调试选项”。
  - 使用 `CDangerButton` 替换定版按钮样式。


提交参考：
- 730604784df19c8f67795bc25e7330e8d93b0056 — feat(setting): 添加调试选项功能

## 2.0.1.0 — 2025-12-02

- 产品定版支持：
  - 在 `PackageConfigItem` 新增 `FinalizeFtpServerPath`，并更新多个产品的配置项以支持定版路径。
  - 修改 `PackageEditWindow` 以支持新增或编辑定版路径。
  - 在 `PackageItem` 与 `PackageInfo` 增加定版相关属性与逻辑。
  - 在 `PackagesHomePage` 添加“定版”按钮并实现点击事件处理。
  - 优化保存配置逻辑，支持重载无需重启。

- 仅下载 ZIP 包：
  - 在 `PackageInfo` 中新增 `DownloadZipOnlyRequested` 事件和相关属性。
  - 实现仅下载 ZIP 包的命令逻辑与状态管理。
  - 在 `PackageUpdateService` 中增加 `DownloadZipOnlyAsync` 方法。

- 导航与入口：
  - 新增定版下载功能入口。

提交参考：
- 8f79235d2c48141170a76652b4ee9d94f0e2324f — feat(package): 添加仅下载ZIP包功能
- c90b397c86bb60097d2057a2156007816e40ffd4 — feat(package): 添加产品定版功能支持

## 2.0.0.0 — 2025-12-01

- 交互与界面重构：
  - 新增 `CommonLinksPage` 与 `CommonLinksWindow`，实现常用网址导航页面。
  - 新增 `LogViewerPage`，支持按类型/日期/级别筛选与搜索日志。
  - 新增 `LocalPathSettingsPage`，支持产品本地路径分组设置。
  - 主窗口集成左侧导航面板与中央页面框架；增加 `ICentralPage` 接口用于页面间通信。
  - 优化数据表格列宽与显示效果。

- 更新日志页面：
  - 新增 `ChangelogPage` 展示 Markdown 格式的更新日志。
  - 新增 `OpenChangelogPageCommand` 命令用于打开更新日志页面。
  - 将 `CHANGELOG.md` 设置为内嵌资源以支持多路径加载。

- 自动更新摘要：
  - 改为异步加载版本更新摘要，避免 UI 阻塞。
  - 将 `UpdateSummary.md` 更名为 `UpdateSummary.txt` 并移出嵌入资源，改为从远程服务器读取。
  - `BuildUpdatePromptContent` 与 `LoadVersionSummaries` 改为异步实现。

- 左侧导航改进：
  - 应用启动时默认选中“产品分类”，统一初始高亮状态。
  - 导航失败不更改选中项（如产品日志目录缺失时保留原选中项）。
- 页面状态策略：离开页面未保存修改不保留，统一采用显式“保存”持久化。
- 包管理配置重构：新增页面 `Views/PackageConfigPage`，抽象 `IPackageEditorHost` 以复用编辑/删除逻辑，更新 `Models/PackageItem` 依赖；主窗口命令改为导航到新页面。
- 主页导航：点击“产品分类”导航到 `PackagesHomePage`，行为一致化。
- 稳定性与交互优化：产品日志路径存在性检查与提示增强，日志查看页加载行为更稳健。

- 缺陷修复：
  - 修复“更新”和“签名取消”功能的启用状态控制不正确的问题。

提交参考：
- ad69b7e8 — feat(update): 异步加载版本更新摘要，改用远程 `UpdateSummary.txt`
- 5d878137 — fix(PackageInfo): 修复更新和签名取消功能启用状态控制
- fdb745d3 — feat(ui): 重构导航与更新日志页面
- 711477f9 — feat(ui): 交互重构（链接、日志、路径、框架与接口）

## 1.0.14.0 — 2025-12-01

- 自动更新提示历史更新要点。


## 1.0.13.0 — 2025-11-28

- 主界面新增筛选功能，支持弹出式筛选条件编辑器。
- 筛选条件持久化：保存/恢复 `DataGrid` 各列的筛选状态。
- 版本排序优化：FTP 目录支持带日期前缀的命名（如 `2025.09.30_v1.5.2`）。
- 常用链接扩充：新增 210 与 215 站点入口。
- 配置预设增强：当当前配置不在列表时自动创建“当前配置”卡片并选中。

提交参考：
- 4277cfe7 — feat(main): 添加筛选与版本排序优化
- 44dcef6e — chore(version): 版本号更新至 1.0.13.0
- 09423eb8 — feat(config): 当前配置缺失时自动创建卡片

## 1.0.12.0 — 2025-11-28

- 更新与签名加密流程支持取消操作（`CancellationToken` 全流程控制）。
- 外部工具运行支持取消与进程终止处理，增强稳定性。
- 新增 PowerShell 脚本：图标生成与程序签名自动化。
- 主窗口常用链接新增“传360”。
- 应用程序图标支持：新增 `App.ico` 并在项目中配置使用。
- 应用配置文件更新。

提交参考：
- f1efbda0 — feat(ui): 取消功能与脚本、链接、版本号至 1.0.12.0
- 88199b17 — feat(app): 更新应用程序配置文件
- 43bafccb — feat(ui): 添加应用程序图标支持

## 1.0.11.0 — 2025-11-28

- 主界面新增常用网址导航与“产品日志”查看功能。
- 集成 LogViewPro、VSCode、记事本多种日志打开方式；内置 LogViewPro。

提交参考：
- 74be57d2 — feat(ui): 常用网址导航与产品日志
- b998646b — chore(version): 版本号至 1.0.11.0

## 1.0.10.0 — 2025-11-27

- 配置预设界面重构：改为粘贴完整 INI 文本；新增 `RawIniContent` 存储原始文本。
- 配置卡片展示优化：高度自适应内容行数；支持按完整文本匹配。
- 新增日志详情查看窗口与双击查看详情功能；引入 `PresetToIniConverter`。
- 工程重构：按功能模块重组到 `Function` 目录；优化命名空间与引用路径；统一 `System.IO.Path`。

提交参考：
- c21ddf81 — feat(config): 预设界面与逻辑重构，版本至 1.0.10.0
- 718678c1 — refactor(project): 文件结构与命名空间优化

## 1.0.9.0 — 2025-11-27

- 本地路径设置支持“按版本配置与获取”。
- 界面展示优化、列索引调整、状态判断修复；更新包服务路径引用逻辑。

提交参考：
- 3a9f93e3 — feat(package): 版本本地路径与界面优化，版本至 1.0.9.0

## 1.0.8.0 — 2025-11-26

- 新增 DNS 设置窗口与编辑对话框：支持添加/编辑/删除 IPv4 DNS。
- 集成系统网络设置跳转；主窗口按产品控制 DNS 功能可见性。

提交参考：
- c9c16b83 — feat(dns): DNS 设置与编辑功能
- 88aaa4bc — chore(version): 版本号至 1.0.8.0

## 1.0.6.0 — 2025-11-25

- 新增“解锁更新”功能：检测并关闭占用进程后继续更新。
- 引入 Windows Restart Manager API：更精确的进程锁定检测。
- 优化更新流程：安全解压、暂存占用文件、完善进度与日志。

提交参考：
- ef3652f0 — feat(package): 解锁更新与流程优化，版本至 1.0.6.0

## 1.0.5.0 — 2025-11-25

- 主窗口布局重构：自定义导航控件、按钮区、搜索框与分栏布局。
- 支持动态分割器调整宽度；统一控件样式（文本块、组合框、进度条）。
- 路径有效性检查逻辑优化：区分路径为空与目录不存在。

提交参考：
- 8dd2bc86 — feat(ui): 主窗口布局与控件样式重构，版本至 1.0.5.0

## 1.0.4.0 — 2025-11-18

- 配置预设管理：新增 `ConfigPreset` 与 `ConfigPresetStore`，支持内置与自定义预设。
- 新增 `ConfigPresetWindow` 与 `AddPresetWindow`；主窗口增加“切换配置”与相关命令。
- 应用自动更新：新增 `AppUpdateService`，支持检查与下载，版本比对与后台替换。
- 进度与状态修复：嵌入工具状态信息失效问题修复；新增 `DebugSettingsService` 与 `EmbeddedToolRunnerService`。

提交参考：
- 9612bc49 — feat(config): 预设配置管理，版本至 1.0.4.0
- 36ce4466 — feat(update): 自动更新功能（配置来源与比对优化）
- 66c53dcc — fix(package): 进度与状态信息修复，版本至 1.0.4.0

## 1.0.3.0 — 2025-11-17

- 日志查看器：支持按类型/日期/级别筛选、搜索与自动滚动；添加打开日志按钮。
- 日志服务与管理员权限：统一日志记录，应用启动时检测并请求管理员权限。
- 自动更新功能首次引入：检查下载与版本比对、替换脚本、错误处理与提示。

提交参考：
- e626464b — feat(log): 日志查看器与解压逻辑优化，版本至 1.0.3
- 870059dd — feat(app): 日志服务与管理员权限自动提升
- ee2ef547 — feat(update): 自动更新功能，版本至 1.0.3.0

## 1.0.2 — 2025-11-12

- 默认阶段初始化：避免仅有“下载”阶段时总进度异常跑满。
- 设置窗口版本号更新为 1.0.2。

提交参考：
- f4b2d7dc — feat(package): 默认阶段初始化
- 2b511b7a — chore(settings): 应用版本号更新至 1.0.2

## 1.0.1 — 2025-11-10

- 本地包路径设置：新增 `LocalPathSettingsWindow` 与 `LocalPathInfo` 展示。
- 调试模式切换：新增 `IsDebugMode` 持久化与 UI 按钮。
- FTP 目录版本号排序与配置操作按钮启用状态控制。
- 设置项：新增程序入口文件是否带 `G` 的选项（`ProgramEntryWithG`）。

提交参考：
- 50151ff0 — feat(settings): 本地包路径设置
- 1e7ec6e9 — feat(package): 调试模式切换
- 46c9067c — feat(ftp): 目录版本排序与按钮启用控制
- f51f4721 — feat(settings): 程序入口文件是否带 G 的配置

## 1.0.0 — 2025-10-31

- 依赖嵌入：集成 Costura.Fody 与 Fody 配置，实现依赖程序集嵌入。
- 应用程序设置与数据管理：主界面状态保存/加载，缓存/状态/数据清除，设置序列化与反序列化。
- 服务能力：应用程序查找（多策略）、数据持久化；FTP 文件列表与时间解析与排序。
- 初始主界面：包管理器主界面基础搭建。

提交参考：
- 4283a5e1 — feat(project): 集成 Costura.Fody
- c130971d — feat(settings): 应用程序设置与数据管理
- 6468c9d9 — feat(services): 应用查找与数据持久化、FTP 文件解析
- ea46a3fa — feat: 包管理器主界面

