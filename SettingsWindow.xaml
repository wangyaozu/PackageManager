<Window x:Class="PackageManager.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PackageManager"
        mc:Ignorable="d"
        Title="设置" Height="400" Width="600" 
        ResizeMode="NoResize" WindowStartupLocation="CenterOwner">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题 -->
        <TextBlock Grid.Row="0" Text="应用程序设置" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>
        
        <!-- 设置内容 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Addin路径设置 -->
                <GroupBox Header="Addin文件夹设置" Margin="0,0,0,20">
                    <StackPanel Margin="10">
                        <TextBlock Text="默认Addin文件夹路径：" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBlock Text="如默认addin文件夹与实际不符，请输入指定路径" 
                                   Foreground="Gray" FontSize="12" Margin="0,0,0,10"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBox x:Name="AddinPathTextBox" Grid.Column="0" 
                                     Text="{Binding AddinPath, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,10,0" Padding="5"/>
                            <Button x:Name="BrowseButton" Grid.Column="1" Content="浏览..." 
                                    Padding="10,5" Click="BrowseButton_Click"/>
                        </Grid>
                        
                        <TextBlock Text="默认路径：C:\ProgramData\Autodesk\Revit\Addins" 
                                   Foreground="Gray" FontSize="11" Margin="0,5,0,0"/>
                        
                        <CheckBox Content="程序入口文件是否带G" IsChecked="{Binding ProgramEntryWithG, UpdateSourceTrigger=PropertyChanged}"
                                  VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,15,0,0"></CheckBox>
                    </StackPanel>
                </GroupBox>

                <!-- 更新服务器地址设置 -->
                <GroupBox Header="更新服务器地址" Margin="0,0,0,20">
                    <StackPanel Margin="10">
                        <TextBlock Text="用于应用自动更新的服务器根路径" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBlock Text="示例：http://server:port/PackageManager/ 或 ftp://server/PackageManager/" 
                                   Foreground="Gray" FontSize="12" Margin="0,0,0,10"/>
                        <TextBox x:Name="UpdateServerUrlTextBox" Text="{Binding UpdateServerUrl, UpdateSourceTrigger=PropertyChanged}" 
                                 Padding="5"/>
                        <TextBlock Text="留空则使用环境变量或内置回退地址" 
                                   Foreground="Gray" FontSize="11" Margin="0,5,0,0"/>
                    </StackPanel>
                </GroupBox>
                
                <!-- 数据管理 -->
                <GroupBox Header="数据管理" Margin="0,0,0,20">
                    <StackPanel Margin="10">
                        <TextBlock Text="清除应用程序数据：" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBlock Text="清除所有保存的配置、缓存和状态数据" 
                                   Foreground="Gray" FontSize="12" Margin="0,0,0,10"/>
                        
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="ClearCacheButton" Content="清除缓存数据" 
                                    Padding="10,5" Margin="0,0,10,0" Click="ClearCacheButton_Click"/>
                            <Button x:Name="ClearStateButton" Content="清除状态数据" 
                                    Padding="10,5" Margin="0,0,10,0" Click="ClearStateButton_Click"/>
                            <Button x:Name="ClearAllButton" Content="清除所有数据" 
                                    Padding="10,5" Background="#FFE74C3C" Foreground="White" 
                                    Click="ClearAllButton_Click"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>
                
                <!-- 应用信息 -->
                <GroupBox Header="应用信息">
                    <StackPanel Margin="10">
                        <TextBlock Text="{Binding AppVersionText}" Margin="0,0,0,5"/>
                        <TextBlock Text="数据存储位置：" FontWeight="Bold" Margin="0,10,0,5"/>
                        <TextBlock x:Name="DataLocationTextBlock" Text="{Binding DataLocation}" 
                                   Foreground="Gray" FontSize="11" TextWrapping="Wrap"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>
        
        <!-- 按钮栏 -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button x:Name="ResetButton" Content="重置为默认" Padding="10,5" 
                    Margin="0,0,10,0" Click="ResetButton_Click"/>
            <Button x:Name="SaveButton" Content="保存" Padding="15,5" 
                    Margin="0,0,10,0" IsDefault="True" Click="SaveButton_Click"/>
            <Button x:Name="CancelButton" Content="取消" Padding="15,5" 
                    IsCancel="True" Click="CancelButton_Click"/>
        </StackPanel>
    </Grid>
</Window>